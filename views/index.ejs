<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Gravity Flux  - Controller</title>
        <link rel="stylesheet" href="css/bootstrap.css">
        <link rel="stylesheet" href="css/main.css">
    </head>
    <body>
        <div class="container" id="main">
            <div id="headings">
                <h1>Gravity Flux</h1>
                <h2>Party Control Panel</h2>
            </div>
            <div id="jitsi_container">
                <iframe id="jitsi_meeting" allow="camera; microphone; fullscreen; display-capture; autoplay" src="<%= jitsi_url %>">
                </iframe>
            </div>
            <div id="controls">
                <span>Set LCD text</span>&nbsp;<input type="text" id="lcd_text"></input><button id="set_text">Set Text</button>
            </div>
        </div>
    </body>
    <script>
        let win_w = 0;
        let win_h = 0;

        function xmlHttpReq(path, key, value){
            var xhttp = new XMLHttpRequest();
            let url = path + "?" + key + "=" + value;
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                // Typical action to be performed when the document is ready:
                    console.log(xhttp.responseText)
                }
            };
            xhttp.open("POST", url, true);
            xhttp.send();
        }

        document.getElementById("set_text").onclick = function(){
            let text_val = document.getElementById("lcd_text").value;
            console.log("Setting text " + text_val);
            xmlHttpReq("set_text", "lcd_text", text_val);
        }

        function resizeVideo(){
            win_h = window.innerWidth;
            win_h = window.innerHeight;
            document.getElementById("main").style.height = (win_h * (2/3)) + "px";
        }
        window.onload = function(){
            resizeVideo()
            console.log('Hello');
        }
        window.onresize = function(){
            resizeVideo()
        }
    </script>
</html>